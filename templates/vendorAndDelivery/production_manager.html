{%load static%}
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" type="text/css" /> -->

    <link rel="stylesheet" href="{%static 'cake-977/vendor-app/libs/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{%static 'cake-977/vendor-app/libs/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{%static 'cake-977/vendor-app/css/dispatch.css'%}" type="text/css">
    <link rel="stylesheet" href="{%static 'cake-977/vendor-app/css/responsive.css'%}" type="text/css">
    <link rel="stylesheet" href="{%static 'cake-977/vendor-app/css/tabview.css'%}" type="text/css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <!-- Vendor CSS -->
    <link rel="stylesheet"  href="//cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css" type="text/css">
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="//cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,500,600,700" rel="stylesheet">

    <title>Cake977-Production Manager</title>
  </head>
  <body id="home2">
    <header>
        <div class="container header___ row">
            <div class=" col-10 head__heading_">
                <h3>Production Manager{%if factory%}-{{factory}}{%endif%}</h3>
            </div>
            <div class="left__header col-lg-2 col-md-2 col-2 d-flex justify-content-end">
                <span class="notification">
                    <i class="fa fa-bell"></i>
                    <a href="#" class="badge badge-notify">{{total_count}}</a>
                </span>
            </div>
        </div>
    </header>
    <section class="container mt-3" style="overflow-x: auto;">
        <div class="dispatch__check_day d-flex">
            <div class="assign__checkbox d-flex">
                <!-- <div class="pr-2">
                    Show unassigned
                </div>
                <form>
                <label class="switch d-flex">
                    <input type="checkbox" {%if assign == True%} checked {%endif%} onclick="this.form.submit();" name="assign" value="assign">
                    <span class="slider round"></span>
                </label>
                </form> -->
            </div>
            <div class="dispatch__day_form pl-3">
                <form>
                    <div class="form-group">
                        <select name="date" onchange="this.form.submit()" class="form-control day__">
                            <option value="today" {%if date_day == 'today'%}selected{%endif%}>Today</option>
                            <option value="yesterday" {%if date_day == 'yesterday'%}selected{%endif%}>Yesterday</option>
                            <option value="tomorrow" {%if date_day == 'tomorrow'%}selected{%endif%}>Tomorrow</option>
                        </select>
                    </div>
                </form>
            </div>
        </div>
        <table id="horizontalTable" class="table table-striped table-bordered table-sm display" cellspacing="0"
            width="100%">
            <thead>
                <tr>
                    <th>Status</th>
                    <th>Order Number</th>
                    <th>Cake Type</th>
                    <th>Baker Assigned</th>
                    <!-- <th>Dispatch Ready</th> -->
                    <th>Dispatch By</th>
                    <th>Delivered By</th>
                    <th>Dispatch Ready Time</th>
                    <th>Dispatched At</th>
                    <th>Delivered At</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {%for order in orders%}
                <tr>
                    {%if order.order_status == 'Completed'%}
                    <td style="color: green;">{{order.order_status}}</td>
                    {%else%}
                    <td>{{order.order_status}}</td>
                    {%endif%}
                    <td>{{order.order_number}}</td>
                    <td>{{order.delivery_address.type_of_cake}}</td>
                    {% if order.vendor_assigned_order%}
                    <td>{{order.vendor_assigned_order.user.first_name|title}}
                        {{order.vendor_assigned_order.user.last_name|title}}</td>
                    {%else%}
                    <td>Baker Not Assigned</td>
                    {%endif%}
                    <td>{{order.dispatch_ready_by.first_name|title}}
                        {{order.dispatch_ready_by.last_name|title}}
                    </td>
                    <!-- <td>{{order.dispatched_by}}</td> -->
                    {%if order.delivery_order.user%}
                    <td>{{order.delivery_order.user.first_name}} {{order.delivery_order.user.last_name}}</td>
                    {%else%}
                    <td>Not Assigned</td>
                    {%endif%}
                    <td>{{order.dispatched_ready_on_time}}</td>
                    <td>{{order.dispatched_on}}</td>
                    <td>{{order.delivered_on}}</td>
                    <td>
                        <a type="button" onclick="openModal('{{order.order_number}}');">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                        </a>
                    </td>
                </tr>
                {%endfor%}
            </tbody>
        </table>
    </section>


    {%for order in orders%}
    <!--ACTION MODAL START-->
    <div class="modal quickModal" id="quickModal-{{order.order_number}}" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="true">
        <div class="modal-dialog modal-dialog-centered " role="document">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Order #: {{order.order_number}}</h4>
                    <button type="button" style="outline: none;" class="close" id="delete-{{order.order_number}}" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <section id="product-detail">

                        <div class="order__cake_ breadcrumb-bg">
                            <div class="breadcrumb ">
                                <ol>
                                    <li>Pickup Date/Time: {{order.pickup_date}},{{order.pickup_time}}</li>
                                </ol>
                            </div>
                        </div>

                        <div class="cake-slider row">
                            {%for i in order.items.all%}
                            <div class="col-md-5 col-lg-5 col-12  center mb-3">
                                {%include 'vendorAndDelivery/image-dispatcher.html'%}
                            </div>
                            <div class="col-md-7 col-lg-7 col-12">
                                <div class="order__cake_detail">
                                    <div class="order_cake">
                                        <div class="cake__header ">
                                            <strong>{{i.product.varient_name|title}}</strong>
                                        </div>
                                        <div class="options has-border mt-1">
                                            <table class="table table-striped">
                                                <tbody>
                                                    <tr>
                                                        <td class="des_title">Quantity</td>
                                                        <td class="description__title">{{i.quantity}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="des_title">Pound</td>
                                                        <td class="description__title">{{i.pound}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Sugarless</td>
                                                        {%if i.is_sugarless%}
                                                        <td class="description-title">Yes</td>
                                                        {%else%}
                                                        <td class="description-title">No</td>
                                                        {%endif%}
                                                    </tr>
                                                    <tr>
                                                        <td>Eggless</td>
                                                        {%if i.is_eggless%}
                                                        <td class="description-title">Yes</td>
                                                        {%else%}
                                                        <td class="description-title">No</td>
                                                        {%endif%}
                                                    </tr>
                                                    <tr>
                                                        <td>Message</td>
                                                        {%if i.special_instruction%}
                                                        <td class="description-title">{{i.special_instruction}}
                                                        </td>
                                                        {%else%}
                                                               <td class="description-title">No any message</td>
                                                        {%endif%}
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            {%endfor%}
                        </div>

                        <hr>

                        <div class="row">
                            <div class="col-md-6 col-lg-6 col-12">
                                <div class="order__cake_remark breadcrumb-bg">
                                    <div class="breadcrumb ">
                                        <h6>Remarks</h6>
                                    </div>
                                    <ol>
                                        <li>{{order.remarks}}</li>
                                    </ol>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-6 col-12">
                                <div class="order__cake_remark breadcrumb-bg">
                                    <div class="breadcrumb ">
                                        <h6>Customer Detail ( Sender )</h6>
                                    </div>
                                    <div class="row" style="padding-left: 16px; display:inline-block !important;">
                                        <div class="user__name">
                                            <label for="">Name: &nbsp;</label>
                                            <span>{{order.delivery_address.sender_fullname|title}}</span>
                                        </div>
                                    
                                    <div class="user__email" style="padding-left: 16px;">
                                        <label for="">Email:&nbsp;</label>
                                        <span>{{order.delivery_address.sender_email}}</span>
                                    </div>
                                    <div class="user__address" style="padding-left: 16px;">
                                        <label for="">Address:&nbsp;</label>
                                        <span>{{order.delivery_address.sender_address}}</span>
                                    </div>
                                    <div class="user__contact" style="padding-left: 16px;">
                                        <label for="">Contact:&nbsp;</label>
                                        <span>{{order.delivery_address.contact_number}}</span>
                                    </div>
                                    <div class="receiver__hide" style="padding-left: 16px;">
                                        <label for="">Hide from Receiver:&nbsp;</label>
                                        <span> {%if order.delivery_address.hide_info_from_receiver%} Yes{%else%} No{%endif%}</span>
                                    </div>
                                </div>
                                </div>
                            </div>
                        </div>

                    </section>
                </div>
            </div>
        </div>
    </div>
    <!--ACTION MODAL END -->
    {%endfor%}


    <!-- Vendor JS -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.blockUI/2.70/jquery.blockUI.js"></script> -->
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js" defer></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="{%static 'cake-977/vendor-app/libs/jquery/jquery.min.js'%}"></script>
    <script src="{%static 'cake-977/vendor-app/libs/bootstrap/js/bootstrap.min.js'%}"></script>

    <script>
        $(document).ready(function () {
            $('table#horizontalTable').DataTable({
                "searching": true,
                "paging": true,
                "order": [[3, "asc"]],
                "ordering": true,
                "columnDefs": [{
                    "targets": [],
                    "orderable": false
                }]
            })
        })
    </script>
    <script>

    function openModal(order_no){
        $('#quickModal-'+order_no).modal('show')
        
        $('#delete-'+order_no).click(function(){
            $('#quickModal-'+order_no).modal('hide')
        })
    }

    </script>

</body>
</html>
